"use strict";(self.webpackChunkreact_remote_component_example=self.webpackChunkreact_remote_component_example||[]).push([[233],{233:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n={};r.r(n),r.d(n,{default:()=>u});var o=r(783),a=r.n(o),s=r(745);const c=({api:e})=>{const[t,r]=(0,o.useState)((()=>e.getEntity())),[n,s]=(0,o.useState)(),c=t.LockInfo&&t.LockInfo.IsLocked&&(!t.LockInfo.IsLockedByMe||!t.LockInfo.IsLockedHere),u=t.State.IsEnabled&&!c,l=(0,o.useCallback)((()=>{r(e.getEntity()),m()}),[e,r]);e.onControlUpdate=l;function m(){s(t.StampInfostarkov.find((()=>!0)))}(0,o.useEffect)((()=>{!function(e){let t=document.getElementById("dynamic-html");t?.childNodes.forEach((e=>{t?.removeChild(e)}));let r=document.createElement("div");r.innerHTML=e,r.className="stamp",t?.appendChild(r)}(n?.StampHtml??"")}),[n?.StampHtml]),(0,o.useEffect)((()=>{var e,t;e=n?.FirstPageAsImage??"",document.getElementById("page").style.backgroundImage=`url(data:image/png;base64,${e})`,t=n?.IsLandscape??!1,new Array(".page","main").map((e=>{const r=document.querySelector(e);r&&(r.style.width=t?"29.7cm":"21cm",r.style.height=t?"21cm":"29.7cm")})),function(){if(!p.current)return;let e=y(n?.CoordX??0),t=y(n?.CoordY??0);f(`X: ${n?.CoordX.toFixed(1)??0}, Y: ${n?.CoordY.toFixed(1)??0}`),E.current.lastX=e,E.current.lastY=t,p.current.style.left=`${e}px`,p.current.style.top=`${t}px`}()}),[n?.FirstPageAsImage]),(0,o.useLayoutEffect)((()=>{m()}),[]);const[d,f]=(0,o.useState)(""),i=(0,o.useRef)(null),p=(0,o.useRef)(null),v=(0,o.useRef)(!1),E=(0,o.useRef)({startX:0,startY:0,lastX:0,lastY:0});function L(e){return e/96*72}function y(e){return 96/72*e}return(0,o.useEffect)((()=>{if(!p.current||!i.current||!u)return;const e=p.current,r=i.current,n=e=>{v.current=!0,E.current.startX=e.clientX,E.current.startY=e.clientY},o=r=>{if(v.current=!1,E.current.lastX===e.offsetLeft&&E.current.lastY===e.offsetTop)return;E.current.lastX=e.offsetLeft,E.current.lastY=e.offsetTop;let n=L(e.offsetLeft),o=L(e.offsetTop);var a,s;f(`X: ${n.toFixed(1)}, Y: ${o.toFixed(1)}`),a=n,s=o,t.StampInfostarkov.forEach((e=>{e?.changeProperty("CoordX",a),e?.changeProperty("CoordY",s)}))},a=t=>{if(!v.current)return;const r=t.clientX-E.current.startX+E.current.lastX,n=t.clientY-E.current.startY+E.current.lastY;e.style.left=`${r}px`,e.style.top=`${n}px`};e.addEventListener("mousedown",n),e.addEventListener("mouseup",o),r.addEventListener("mousemove",a),r.addEventListener("mouseleave",o);return()=>{e.removeEventListener("mousedown",n),e.removeEventListener("mouseup",o),r.removeEventListener("mousemove",a),r.removeEventListener("mouseleave",o)}}),[]),a().createElement("main",null,a().createElement("label",{id:"coords"},d),a().createElement("br",null),a().createElement("div",{id:"page",className:"page",ref:i},a().createElement("div",{id:"dynamic-html",className:"stamp",ref:p})))},u=e=>{const t=(0,s.s)(e.container);return t.render(o.createElement(c,{api:e.api})),Promise.resolve((()=>t.unmount()))},l={"stamp-control-loader":n}},745:(e,t,r)=>{var n=r(167);t.s=n.createRoot,n.hydrateRoot}}]);
//# sourceMappingURL=233_1.1_ef98f4c3.js.map